# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
  paths:
    exclude:
    - README.md

pr: none

jobs:
- job: Build
  displayName: Build App
  pool:
    vmImage: 'Ubuntu 16.04'
  steps:
  - task: NodeTool@0
    inputs:
      versionSpec: '10.12.x'
  - script: |
      printenv
      yarn
      yarn build:tools
      yarn tools:prepare-lib
      yarn ng build alyle-ui --aot --output-path dist/alyle-ui-aot
      yarn build
- job: TestOnWindows
  displayName: Build docs
  pool:
    vmImage: 'Ubuntu 16.04'
  steps:
  - task: NodeTool@0
    inputs:
      versionSpec: '10.12.x'
  - script: |
      yarn
      yarn build:tools
      yarn tools:prepare-lib
      yarn build:@alyle/ui
      export THEVAR=$(git show -s --format=%s)
      export THEVAR=$(git rev-parse HEAD)
      yarn bundlesizelimit
    displayName: build:@alyle/ui
  - script: |
      yarn tools:typedoc
      node dist/tools/docs-content
      node dist/tools/generate-demos
    displayName: Build docs-content
